{"version":3,"file":"DCwy3NfF.js","sources":["../../../../pages/index/products.vue"],"sourcesContent":["<template>\r\n    <v-container>\r\n        <v-row>\r\n            <v-col cols=\"12\" sm=\"4\" class=\"pr-0\">\r\n                <v-card flat border>\r\n                    <v-card-text class=\"w-100 text-primary d-flex justify-space-between align-center\">\r\n                        <span>{{ $t('products.search_by_name') }}</span>\r\n                    </v-card-text>\r\n                    <v-card-text class=\"py-0 pb-1\">\r\n                        <v-text-field :placeholder=\"$t('products.search_by_name')\" append-inner-icon=\"mdi-magnify\" flat\r\n                            density=\"compact\" class=\"border rounded\" hide-details variant=\"solo\" bg-color=\"background\"\r\n                            color=\"primary\" v-model=\"filters.search\" @update:model-value=\"setValue('search', $event)\"></v-text-field>\r\n                    </v-card-text>\r\n                    <v-card-text class=\"pb-0 pt-2\">\r\n                        <span class=\"text-primary\">{{ $t('products.search_by_price') }}</span>\r\n                    </v-card-text>\r\n                    <v-card-text class=\"pb-0 pt-2 px-3\">\r\n                        <v-row class=\"pa-2\">\r\n                            <v-col class=\"pa-2\" cols=\"6\">\r\n                                <v-text-field min=\"0\" v-model=\"filters.min_price\" @update:model-value=\"setValue('min_price', +$event)\" bg-color=\"background\" class=\"border rounded\" type=\"number\" variant=\"solo\" flat hide-details density=\"compact\" :placeholder=\"$t('products.min')\"></v-text-field>\r\n                            </v-col>\r\n                            <v-col class=\"pa-2\" cols=\"6\">\r\n                                <v-text-field min=\"0\" v-model=\"filters.max_price\" @update:model-value=\"setValue('max_price', +$event)\" bg-color=\"background\" class=\"border rounded\" type=\"number\" variant=\"solo\" flat hide-details density=\"compact\" :placeholder=\"$t('products.max')\"></v-text-field>\r\n                            </v-col>\r\n                        </v-row>\r\n                    </v-card-text>\r\n                    <v-card-text class=\"pb-0\">\r\n                        <span class=\"text-primary\">{{ $t('products.categories') }}</span>\r\n                    </v-card-text>\r\n                    <v-card-text class=\"py-0\">\r\n                        <v-list\r\n                            :items=\"categoires\"\r\n                            item-children=\"children\"\r\n                            :item-title=\"`name_${$i18n.locale}`\"\r\n                            density=\"compact\"\r\n                            nav\r\n                            class=\"px-0\"\r\n                            open-strategy=\"single\"\r\n                            item-value=\"id\"\r\n                            mandatory\r\n                            v-model=\"filters.category\"\r\n                            active-class=\"text-primary\"\r\n                            >\r\n                            <template #title=\"{title,item}\">\r\n                                <span class=\"font-weight-light text-hover-link\" :class=\"{ 'text-primary': (filters.category as any) === item.id }\" @click.stop=\"setValue('category', item.id)\">{{ title }}</span>\r\n                            </template>\r\n                            <template #append=\"{item, isActive}\">\r\n                                <v-icon v-if=\"item.children!.length\">mdi-{{ isActive?'minus':'plus' }}</v-icon>\r\n                            </template>\r\n                        </v-list>\r\n                    </v-card-text>\r\n                    <v-card-text class=\"py-0\">\r\n                        <span class=\"text-primary\">{{ $t('products.brands') }}</span>\r\n                    </v-card-text>\r\n                    <v-card-text class=\"py-0\">\r\n                        <v-list density=\"compact\" nav class=\"px-0\" mandatory color=\"primary\">\r\n                            <v-list-item class=\"py-0\" v-for=\"b,i in brands\" :key=\"i\" :active=\"(filters.brand as any) === b.id\" height=\"25\" :value=\"b.id\" link @click=\"setValue('brand', b.id)\">\r\n                                {{ b.name }}\r\n                            </v-list-item>\r\n                        </v-list>\r\n                    </v-card-text>\r\n                </v-card>\r\n            </v-col>\r\n            <v-col cols=\"12\" sm=\"8\" v-if=\"loading\">\r\n                <p class=\"text-center text-grey font-weight-light\">{{ $t('loading') }}...</p>\r\n            </v-col>\r\n            <v-col cols=\"12\" sm=\"8\" v-else>\r\n                <v-list class=\"py-0 px-0\" bg-color=\"background\">\r\n                    <p v-if=\"!loading&&items.length===0\" class=\"text-center text-grey font-weight-light\">{{$t('no_data')}}</p>\r\n                    <AppProductList v-for=\"item,i in items\" :key=\"i\" :product=\"item\" />\r\n                </v-list>\r\n                <v-pagination density=\"comfortable\" :length=\"Math.ceil(count/25)\" :model-value=\"+filters.page\" @update:model-value=\"setValue('page', $event)\" variant=\"flat\" active-color=\"primary\"></v-pagination>\r\n            </v-col>\r\n        </v-row>\r\n    </v-container>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport lodash from 'lodash'\r\nimport type { IBrand, ICategory, IProduct } from '@/types'\r\n\r\nuseHead({\r\n    title: \"Искать Медицинское Оборудование в Узбекистане\",\r\n    meta: [\r\n        {name: \"description\", content: \"Найдите широкий ассортимент медицинского оборудования в Узбекистане. Качественные товары, высокий уровень сервиса. Покупайте оборудование для здравоохранения у надежных поставщиков.\"},\r\n        {name: \"keywords\", content: \"медицинское оборудование, Узбекистан, оборудование для здравоохранения, медицинские товары, медтехника, поставщики, купить оборудование\"},\r\n    ]\r\n})\r\n\r\ndefinePageMeta({\r\n    layout: 'index-layout',\r\n})\r\n\r\nconst { getAllProducts } = useProducts()\r\nconst { getTree } = useCategories()\r\nconst { getAllBrands } = useBrands()\r\n\r\nconst categoires = ref<ICategory[]>([])\r\nconst brands = ref<IBrand[]>([])\r\n\r\nconst count = ref(0)\r\nconst route = useRoute()\r\nconst loading = ref(true)\r\nconst items = ref<IProduct[]>([])\r\n\r\nconst router = useRouter()\r\nconst filters = reactive({\r\n    search: route.query.search || '',\r\n    brand: route.query.brand || '',\r\n    category: route.query.category || '',\r\n    min_price:  route.query.min_price || 0,\r\n    max_price: route.query.max_price || 0,\r\n    page: route.query.page || 1,\r\n    for_sale: true,\r\n})\r\n\r\nconst setValue = (key: keyof typeof filters, value: any) => {\r\n    if(route.query[key] == value) return\r\n\r\n    const updatedQuery = { ...route.query };\r\n    if (value === 0 || value === '') delete updatedQuery[key]\r\n    else updatedQuery[key] = value\r\n\r\n    filters[key] = value\r\n    \r\n    router.replace({ path: '/products', query: updatedQuery })\r\n    getProducts()\r\n}\r\n\r\n// const removeFilters = () => {\r\n//     Object.assign(filters, {\r\n//         search: '',\r\n//         brand: '',\r\n//         category: '',\r\n//         min_price: 0,\r\n//         max_price: 0,\r\n//         is_part: '',\r\n//     })\r\n//     router.replace({ path: '/products', query: {} })\r\n//     getProducts()\r\n// }\r\n\r\nconst getProducts = lodash.debounce(async () => {\r\n    loading.value = true\r\n    items.value = []\r\n    const data: any = await getAllProducts(location?.search?location?.search+'&expand=images':'?expand=images')\r\n    items.value = data.results\r\n    // count.value = data.count\r\n    // console.log(data)\r\n    loading.value = false\r\n}, 500)\r\n\r\nconst init = async () => {\r\n    const [c,b,_]: any = await Promise.all([\r\n        getTree(),\r\n        getAllBrands(''),\r\n        getProducts()\r\n    ])\r\n\r\n    categoires.value = c\r\n    brands.value = b.results\r\n}\r\n\r\nawait init()\r\n</script>"],"names":["useHead","getAllProducts","useProducts","getTree","useCategories","getAllBrands","useBrands","categoires","ref","brands","count","route","useRoute","loading","items","router","useRouter","filters","reactive","setValue","key","value","updatedQuery","getProducts","lodash","data","init","c","b","_","__temp","__restore","_withAsyncContext"],"mappings":"omDAiFQA,GAAA,CACJ,MAAO,gDACP,KAAM,CACF,CAAC,KAAM,cAAe,QAAS,uLAAuL,EACtN,CAAC,KAAM,WAAY,QAAS,yIAAyI,CACzK,CAAA,CACH,EAMK,KAAA,CAAE,eAAAC,GAAmBC,KACrB,CAAE,QAAAC,GAAYC,KACd,CAAE,aAAAC,GAAiBC,KAEnBC,EAAaC,EAAiB,CAAA,CAAE,EAChCC,EAASD,EAAc,CAAA,CAAE,EAEzBE,EAAQF,EAAI,CAAC,EACbG,EAAQC,IACRC,EAAUL,EAAI,EAAI,EAClBM,EAAQN,EAAgB,CAAA,CAAE,EAE1BO,EAASC,IACTC,EAAUC,EAAS,CACrB,OAAQP,EAAM,MAAM,QAAU,GAC9B,MAAOA,EAAM,MAAM,OAAS,GAC5B,SAAUA,EAAM,MAAM,UAAY,GAClC,UAAYA,EAAM,MAAM,WAAa,EACrC,UAAWA,EAAM,MAAM,WAAa,EACpC,KAAMA,EAAM,MAAM,MAAQ,EAC1B,SAAU,EAAA,CACb,EAEKQ,EAAW,CAACC,EAA2BC,IAAe,CACrD,GAAAV,EAAM,MAAMS,CAAG,GAAKC,EAAO,OAE9B,MAAMC,EAAe,CAAE,GAAGX,EAAM,KAAM,EAClCU,IAAU,GAAKA,IAAU,GAAI,OAAOC,EAAaF,CAAG,EACnDE,EAAaF,CAAG,EAAIC,EAEzBJ,EAAQG,CAAG,EAAIC,EAEfN,EAAO,QAAQ,CAAE,KAAM,YAAa,MAAOO,EAAc,EAC7CC,GAAA,EAgBVA,EAAcC,GAAO,SAAS,SAAY,CAC5CX,EAAQ,MAAQ,GAChBC,EAAM,MAAQ,GACR,MAAAW,EAAY,MAAMxB,EAAe,yBAAU,QAAO,+BAAU,QAAO,iBAAiB,gBAAgB,EAC1Ga,EAAM,MAAQW,EAAK,QAGnBZ,EAAQ,MAAQ,IACjB,GAAG,EAEAa,EAAO,SAAY,CACrB,KAAM,CAACC,EAAEC,EAAEC,CAAC,EAAS,MAAM,QAAQ,IAAI,CACnC1B,EAAQ,EACRE,EAAa,EAAE,EACfkB,EAAY,CAAA,CACf,EAEDhB,EAAW,MAAQoB,EACnBlB,EAAO,MAAQmB,EAAE,OAAA,EAGrB,OAAAE,EAAAC,CAAA,EAAAC,GAAA,IAAMN,EAAA,CAAK"}